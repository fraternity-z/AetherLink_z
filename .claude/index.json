{
  "version": "1.1.0",
  "timestamp": "2025-11-16T05:48:51.000Z",
  "project": {
    "name": "AetherLink_z",
    "description": "跨平台 AI 聊天助手应用",
    "tech_stack": {
      "framework": "React Native 0.81.5 + Expo 54",
      "router": "Expo Router (文件路由)",
      "ui": "React Native Paper 5.14.5",
      "state": "React Hooks + Context",
      "database": "Expo SQLite",
      "ai_sdk": "Vercel AI SDK 5.0.86",
      "mcp": "Model Context Protocol SDK 1.21.1",
      "voice": "@react-native-voice/voice 3.2.4",
      "language": "TypeScript 5.9.2"
    },
    "platforms": ["iOS", "Android", "Web"]
  },
  "statistics": {
    "total_files": 150,
    "source_files": 134,
    "total_lines": 25596,
    "total_modules": 16,
    "documented_modules": 16,
    "coverage": "100%",
    "test_coverage": "0%",
    "breakdown": {
      "app": {
        "files": 18,
        "lines": 3620,
        "description": "应用页面和路由 (Expo Router)"
      },
      "components": {
        "files": 40,
        "lines": 9260,
        "description": "UI 组件 (聊天、设置、通用、Provider)"
      },
      "services": {
        "files": 35,
        "lines": 5671,
        "description": "业务服务 (AI、搜索、MCP、语音、数据)"
      },
      "storage": {
        "files": 16,
        "lines": 2178,
        "description": "数据持久化 (SQLite、Repository)"
      },
      "hooks": {
        "files": 13,
        "lines": 2455,
        "description": "React Hooks 业务逻辑"
      },
      "utils": {
        "files": 8,
        "lines": 1748,
        "description": "通用工具函数"
      },
      "constants": {
        "files": 4,
        "lines": 664,
        "description": "应用常量和配置"
      }
    },
    "exports": {
      "services_ai": {
        "count": 66,
        "files": 11,
        "description": "AI 服务导出 (流式补全、模型发现、能力识别等)"
      },
      "hooks": {
        "count": 22,
        "files": 12,
        "description": "Hooks 导出 (对话、消息、设置、语音等)"
      },
      "storage_repositories": {
        "count": 17,
        "files": 12,
        "description": "数据仓库导出 (CRUD 操作)"
      }
    }
  },
  "modules": [
    {
      "path": "app/",
      "type": "页面路由",
      "role": "应用页面和路由结构(Expo Router)",
      "entry_files": ["index.tsx", "_layout.tsx"],
      "key_files": [
        "settings/index.tsx",
        "settings/appearance.tsx",
        "settings/behavior.tsx",
        "settings/providers/[vendor].tsx",
        "settings/custom-providers/[id].tsx",
        "settings/mcp-server.tsx",
        "settings/quick-phrases.tsx",
        "topics/index.tsx"
      ],
      "dependencies": [
        "expo-router",
        "@react-navigation/native",
        "components/*",
        "hooks/*"
      ],
      "features": [
        "文件路由系统",
        "Stack 导航",
        "动态路由参数",
        "Provider 集成",
        "双击手势快捷短语"
      ],
      "documentation": "app/CLAUDE.md",
      "test_status": "无测试"
    },
    {
      "path": "components/chat/",
      "type": "UI组件",
      "role": "聊天界面相关组件",
      "entry_files": ["ChatInput.tsx", "MessageList.tsx", "MessageBubble.tsx"],
      "key_files": [
        "message/ThinkingBlock.tsx",
        "message/ToolBlock.tsx",
        "message/MarkdownRenderer.tsx",
        "input/VoiceInputButton.tsx",
        "dialogs/ModelPickerDialog.tsx",
        "dialogs/McpToolsDialog.tsx",
        "dialogs/ImageGenerationDialog.tsx",
        "sidebar/ChatHeader.tsx",
        "sidebar/TopicsSidebar.tsx"
      ],
      "dependencies": [
        "react-native-paper",
        "@react-navigation/native",
        "services/ai/*",
        "storage/repositories/*"
      ],
      "features": [
        "流式消息显示",
        "Markdown 渲染",
        "思考链展示",
        "工具调用块",
        "语音输入",
        "图片生成"
      ],
      "documentation": "components/chat/CLAUDE.md",
      "test_status": "无测试"
    },
    {
      "path": "components/settings/",
      "type": "UI组件",
      "role": "设置页面相关组件",
      "entry_files": ["SettingsList.tsx", "ModelDiscoveryDialog.tsx"],
      "key_files": [
        "SettingScreen.tsx",
        "QuickPhraseEditDialog.tsx"
      ],
      "dependencies": [
        "react-native-paper",
        "services/ai/ModelDiscovery"
      ],
      "features": [
        "设置列表",
        "模型发现",
        "快捷短语编辑"
      ],
      "documentation": "components/settings/CLAUDE.md",
      "test_status": "无测试"
    },
    {
      "path": "components/common/",
      "type": "UI组件",
      "role": "通用UI组件(弹窗、对话框等)",
      "entry_files": ["ConfirmDialog.tsx", "InputDialog.tsx"],
      "key_files": [
        "UnifiedDialog.tsx",
        "UserAvatar.tsx"
      ],
      "dependencies": [
        "react-native-paper"
      ],
      "features": [
        "确认对话框",
        "输入对话框",
        "统一弹窗系统"
      ],
      "documentation": "components/common/CLAUDE.md",
      "test_status": "无测试"
    },
    {
      "path": "components/providers/",
      "type": "UI组件",
      "role": "React Context 提供者",
      "entry_files": ["ThemeProvider.tsx", "DataProvider.tsx", "SettingsProvider.tsx"],
      "key_files": [
        "HiddenWebViewHost.tsx"
      ],
      "dependencies": [
        "react-native-paper",
        "storage/sqlite/db",
        "hooks/use-color-scheme"
      ],
      "features": [
        "主题管理",
        "设置状态管理",
        "数据初始化",
        "隐藏 WebView 服务"
      ],
      "documentation": "components/providers/CLAUDE.md",
      "test_status": "无测试"
    },
    {
      "path": "services/ai/",
      "type": "业务服务",
      "role": "AI提供商集成和流式响应",
      "entry_files": ["AiClient.ts", "discovery/ModelDiscovery.ts"],
      "key_files": [
        "capabilities/ModelCapabilities.ts",
        "integration/mcpIntegration.ts",
        "validation/ModelValidation.ts",
        "utils/TopicNaming.ts",
        "utils/errors.ts"
      ],
      "dependencies": [
        "ai",
        "@ai-sdk/openai",
        "@ai-sdk/anthropic",
        "@ai-sdk/google",
        "storage/repositories/providers"
      ],
      "features": [
        "多提供商支持 (OpenAI, Anthropic, Google, DeepSeek, 火山方舟, 智谱)",
        "流式响应",
        "模型发现",
        "模型能力检测",
        "思考链支持",
        "MCP 工具集成"
      ],
      "documentation": "services/ai/CLAUDE.md",
      "test_status": "无测试"
    },
    {
      "path": "services/data/",
      "type": "业务服务",
      "role": "数据备份、清理、统计服务",
      "entry_files": ["DataBackup.ts", "DataCleanup.ts", "DataStats.ts"],
      "dependencies": [
        "storage/repositories/*",
        "expo-file-system",
        "expo-sharing"
      ],
      "features": [
        "数据导出到 JSON",
        "数据分享",
        "数据清理",
        "存储统计"
      ],
      "documentation": "services/data/CLAUDE.md",
      "test_status": "无测试"
    },
    {
      "path": "services/search/",
      "type": "业务服务",
      "role": "网络搜索引擎集成",
      "entry_files": ["SearchClient.ts", "engines/"],
      "key_files": [
        "engines/BingSearch.ts",
        "engines/GoogleSearch.ts",
        "engines/TavilySearch.ts",
        "utils/http-client.ts",
        "utils/html-parser.ts",
        "utils/search-cache.ts"
      ],
      "dependencies": [
        "services/webview/HiddenWebViewClient",
        "utils/http"
      ],
      "features": [
        "多搜索引擎支持 (Bing, Google, Tavily)",
        "反爬虫绕过",
        "结果缓存",
        "HTML 解析"
      ],
      "documentation": "services/search/CLAUDE.md",
      "test_status": "无测试"
    },
    {
      "path": "services/mcp/",
      "type": "业务服务",
      "role": "MCP 工具集成服务",
      "entry_files": ["McpClient.ts"],
      "key_files": [
        "CacheManager.ts"
      ],
      "dependencies": [
        "@modelcontextprotocol/sdk",
        "storage/repositories/mcp",
        "ai"
      ],
      "features": [
        "MCP 服务器连接管理",
        "工具列表和调用",
        "资源读取",
        "提示词获取",
        "工具转换 (MCP → AI SDK)",
        "缓存管理"
      ],
      "documentation": "services/mcp/CLAUDE.md",
      "test_status": "无测试"
    },
    {
      "path": "services/voice/",
      "type": "业务服务",
      "role": "语音识别服务",
      "entry_files": ["VoiceRecognition.ts", "NativeRecognition.ts", "WhisperRecognition.ts"],
      "dependencies": [
        "@react-native-voice/voice",
        "expo-audio"
      ],
      "features": [
        "设备端语音识别",
        "Whisper API 识别",
        "音频录制和上传"
      ],
      "documentation": "services/voice/CLAUDE.md",
      "test_status": "无测试"
    },
    {
      "path": "services/webview/",
      "type": "业务服务",
      "role": "隐藏WebView服务（反爬虫）",
      "entry_files": ["HiddenWebViewClient.ts"],
      "dependencies": [
        "react-native-webview"
      ],
      "features": [
        "隐藏 WebView 容器",
        "JavaScript 执行",
        "双向通信",
        "Cookie 管理"
      ],
      "documentation": "services/webview/CLAUDE.md",
      "test_status": "无测试"
    },
    {
      "path": "services/messageStreaming/",
      "type": "业务服务",
      "role": "消息块管理（流式响应）",
      "entry_files": ["BlockManager.ts"],
      "dependencies": [
        "storage/repositories/message-blocks",
        "utils/events"
      ],
      "features": [
        "消息块管理",
        "智能缓冲写入",
        "工具调用块",
        "toolCallId 映射"
      ],
      "documentation": "services/messageStreaming/CLAUDE.md",
      "test_status": "无测试"
    },
    {
      "path": "storage/",
      "type": "数据层",
      "role": "数据持久化和访问层",
      "entry_files": ["core.ts", "sqlite/db.ts"],
      "key_files": [
        "repositories/chat.ts",
        "repositories/messages.ts",
        "repositories/attachments.ts",
        "repositories/providers.ts",
        "repositories/provider-models.ts",
        "repositories/assistants.ts",
        "repositories/custom-providers.ts",
        "repositories/thinking-chains.ts",
        "repositories/quick-phrases.ts",
        "repositories/mcp.ts",
        "repositories/settings.ts",
        "repositories/message-blocks.ts",
        "sqlite/migrations/0001_init.ts",
        "adapters/async-storage.ts"
      ],
      "dependencies": [
        "expo-sqlite",
        "@react-native-async-storage/async-storage"
      ],
      "features": [
        "SQLite 数据库管理",
        "数据库迁移",
        "Repository 模式",
        "跨平台存储适配",
        "事务支持"
      ],
      "data_models": [
        "Conversation",
        "Message",
        "Attachment",
        "ThinkingChain",
        "QuickPhrase",
        "MessageBlock",
        "Provider",
        "ProviderModel",
        "MCPServer"
      ],
      "documentation": "storage/CLAUDE.md",
      "test_status": "无测试"
    },
    {
      "path": "hooks/",
      "type": "逻辑层",
      "role": "React Hooks,封装业务逻辑",
      "entry_files": ["use-conversations.ts", "use-messages.ts", "use-setting.ts"],
      "key_files": [
        "use-color-scheme.ts",
        "use-confirm-dialog.tsx",
        "use-image-generation.ts",
        "use-voice-recognition.ts",
        "use-quick-phrases.ts",
        "use-user-profile.ts",
        "use-message-sender.ts",
        "use-web-search.ts",
        "use-microphone-permission.ts",
        "use-voice-recording.ts"
      ],
      "dependencies": [
        "storage/repositories/*",
        "services/*"
      ],
      "features": [
        "对话管理",
        "消息管理",
        "设置管理",
        "主题系统",
        "弹窗系统",
        "语音识别",
        "图片生成",
        "快捷短语"
      ],
      "documentation": "hooks/CLAUDE.md",
      "test_status": "无测试"
    },
    {
      "path": "constants/",
      "type": "配置",
      "role": "应用常量和主题配置",
      "entry_files": ["theme.ts", "prompts.ts", "assistants.ts"],
      "key_files": [
        "mcp.ts"
      ],
      "dependencies": [
        "react-native-paper"
      ],
      "features": [
        "Material Design 3 主题",
        "明暗模式切换",
        "AI 提示词模板",
        "AI 助手预设",
        "MCP 配置"
      ],
      "documentation": "constants/CLAUDE.md",
      "test_status": "无测试"
    },
    {
      "path": "utils/",
      "type": "工具",
      "role": "通用工具函数",
      "entry_files": ["logger.ts", "render-cache.ts", "events.ts", "http.ts"],
      "key_files": [
        "classnames.ts",
        "model-logo.ts",
        "mcpSchema.ts",
        "mcpTool.ts"
      ],
      "dependencies": [],
      "features": [
        "结构化日志系统",
        "渲染缓存",
        "事件总线",
        "HTTP 工具",
        "模型 Logo 映射",
        "MCP Schema 工具"
      ],
      "documentation": "utils/CLAUDE.md",
      "test_status": "无测试"
    }
  ],
  "coverage_analysis": {
    "scanned_modules": 16,
    "documented_modules": 16,
    "missing_documentation": [],
    "missing_tests": [
      "app/",
      "components/chat/",
      "components/settings/",
      "components/common/",
      "components/providers/",
      "services/ai/",
      "services/data/",
      "services/search/",
      "services/mcp/",
      "services/voice/",
      "services/webview/",
      "services/messageStreaming/",
      "storage/",
      "hooks/",
      "constants/",
      "utils/"
    ],
    "documentation_coverage": "100%",
    "test_coverage": "0%"
  },
  "next_steps": [
    "添加自动化测试（单元测试、集成测试、E2E 测试）",
    "实现数据恢复功能（从备份文件恢复）",
    "优化性能（消息列表虚拟化、图片懒加载）",
    "添加更多 AI 提供商支持",
    "实现消息搜索功能",
    "添加数据同步功能（云端备份）",
    "完善错误处理和用户反馈",
    "添加使用分析和崩溃报告",
    "优化 Markdown 渲染性能",
    "添加消息编辑和删除功能",
    "实现对话导出（Markdown、PDF）",
    "支持更多附件类型（视频、音频）"
  ],
  "ignore_rules": [
    "node_modules/**",
    ".git/**",
    ".github/**",
    "dist/**",
    "build/**",
    ".next/**",
    "__pycache__/**",
    "*.lock",
    "*.log",
    "*.bin",
    "*.pdf",
    "*.png",
    "*.jpg",
    "*.jpeg",
    "*.gif",
    "*.mp4",
    "*.zip",
    "*.tar",
    "*.gz",
    ".expo/",
    "web-build/",
    "expo-env.d.ts",
    ".kotlin/",
    "*.orig.*",
    "*.jks",
    "*.p8",
    "*.p12",
    "*.key",
    "*.mobileprovision",
    ".metro-health-check*",
    "*.pem",
    ".env*.local",
    "*.tsbuildinfo",
    "app-example",
    "/ios"
  ],
  "scan_metadata": {
    "scanned_at": "2025-11-16T05:48:51.000Z",
    "scan_duration_ms": 0,
    "truncated": false,
    "truncation_reason": null,
    "scan_strategy": "增量更新扫描（验证模式）",
    "files_scanned": 150,
    "files_ignored": 0,
    "total_size_bytes": 0,
    "scan_mode": "validation",
    "changes_detected": [
      "更新代码行数统计",
      "验证文档完整性",
      "确认接口导出数量",
      "更新元数据时间戳"
    ]
  }
}
