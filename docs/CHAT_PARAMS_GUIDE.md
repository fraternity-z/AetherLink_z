# èŠå¤©å‚æ•°è®¾ç½®æŒ‡å—

## ğŸ“‹ åŠŸèƒ½æ¦‚è¿°

èŠå¤©å‚æ•°è®¾ç½®å…è®¸æ‚¨ç²¾ç»†æ§åˆ¶ AI å¯¹è¯çš„è¡Œä¸ºã€‚æ‰€æœ‰å‚æ•°éƒ½ä¼šå®æ—¶ä¿å­˜å¹¶ç«‹å³ç”Ÿæ•ˆã€‚

## ğŸ›ï¸ å¯è°ƒå‚æ•°

### 1ï¸âƒ£ Temperatureï¼ˆæ¸©åº¦ï¼‰

**ä½œç”¨**: æ§åˆ¶ AI å›å¤çš„éšæœºæ€§å’Œåˆ›é€ æ€§

**å–å€¼èŒƒå›´**: 0.0 - 2.0

**æ¨èå€¼**:
- **0.2 - 0.5**: æ›´å‡†ç¡®ã€æ›´ä¸€è‡´çš„å›å¤ï¼ˆé€‚åˆç¼–ç¨‹ã€æ•°å­¦ç­‰ä»»åŠ¡ï¼‰
- **0.7 - 1.0**: å¹³è¡¡åˆ›é€ æ€§å’Œå‡†ç¡®æ€§ï¼ˆé€‚åˆæ—¥å¸¸å¯¹è¯ï¼‰
- **1.0 - 2.0**: æ›´æœ‰åˆ›æ„ã€æ›´å¤šæ ·åŒ–ï¼ˆé€‚åˆåˆ›æ„å†™ä½œï¼‰

**é»˜è®¤å€¼**: 0.7

---

### 2ï¸âƒ£ Max Tokensï¼ˆæœ€å¤§ä»¤ç‰Œæ•°ï¼‰

**ä½œç”¨**: é™åˆ¶å•æ¬¡å›å¤çš„æœ€å¤§é•¿åº¦

**æ˜¯å¦å¯ç”¨**: âœ… å¯é€‰ï¼ˆæœ‰å¼€å…³æŒ‰é’®ï¼‰

**å–å€¼èŒƒå›´**: 256 - 8192

**è¯´æ˜**:
- **å¼€å¯**: AI å›å¤ä¸ä¼šè¶…è¿‡è®¾å®šçš„ä»¤ç‰Œæ•°
- **å…³é—­**: AI è‡ªåŠ¨å†³å®šå›å¤é•¿åº¦ï¼ˆæ¨èï¼‰

**æ¨èå€¼**:
- **256 - 1024**: ç®€çŸ­å›å¤
- **2048**: æ ‡å‡†å›å¤ï¼ˆé»˜è®¤å€¼ï¼‰
- **4096 - 8192**: é•¿æ–‡æœ¬å›å¤

**é»˜è®¤**: å…³é—­ï¼ˆç”±æ¨¡å‹è‡ªåŠ¨å†³å®šï¼‰

---

### 3ï¸âƒ£ ä¸Šä¸‹æ–‡æ•°ç›®ï¼ˆContext Countï¼‰

**ä½œç”¨**: ä¿ç•™å¤šå°‘è½®å†å²å¯¹è¯ä½œä¸ºä¸Šä¸‹æ–‡

**å–å€¼èŒƒå›´**: 0 - 20

**è¯´æ˜**:
- **0**: ä¸åŒ…å«å†å²ä¸Šä¸‹æ–‡ï¼Œæ¯æ¬¡å¯¹è¯ç‹¬ç«‹
- **5 - 10**: æ ‡å‡†ä¸Šä¸‹æ–‡ï¼ˆæ¨èï¼‰
- **15 - 20**: é•¿ä¸Šä¸‹æ–‡ï¼Œä½†ä¼šæ¶ˆè€—æ›´å¤šä»¤ç‰Œ

**æ³¨æ„**:
- 1 è½®å¯¹è¯ = 1 ä¸ªç”¨æˆ·æ¶ˆæ¯ + 1 ä¸ª AI å›å¤
- æ›´å¤šä¸Šä¸‹æ–‡ä¼šå¢åŠ  API è°ƒç”¨æˆæœ¬

**é»˜è®¤å€¼**: 10

---

### 4ï¸âƒ£ ç³»ç»Ÿæç¤ºè¯ï¼ˆSystem Promptï¼‰

**ä½œç”¨**: å®šä¹‰ AI çš„è§’è‰²ã€è¡Œä¸ºå’Œå›å¤é£æ ¼

**è¯´æ˜**:
- ç‚¹å‡»"ç¼–è¾‘"æŒ‰é’®å¯ä¿®æ”¹ç³»ç»Ÿæç¤ºè¯
- æ”¯æŒå¤šè¡Œè¾“å…¥
- ç«‹å³ç”Ÿæ•ˆäºæ–°å¯¹è¯

**ç¤ºä¾‹æç¤ºè¯**:

```
ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„ç¼–ç¨‹åŠ©æ‰‹ï¼Œç²¾é€šå¤šç§ç¼–ç¨‹è¯­è¨€ã€‚
è¯·ç”¨ç®€æ´ã€å‡†ç¡®çš„æ–¹å¼å›ç­”é—®é¢˜ï¼Œå¹¶æä¾›ä»£ç ç¤ºä¾‹ã€‚
```

```
ä½ æ˜¯ä¸€ä¸ªå‹å¥½çš„ AI åŠ©æ‰‹ï¼Œç”¨è½»æ¾ã€å¹½é»˜çš„è¯­æ°”ä¸ç”¨æˆ·äº¤æµã€‚
```

**é»˜è®¤å€¼**: `You are a helpful assistant.`

---

### 5ï¸âƒ£ æµå¼è¾“å‡ºï¼ˆStream Outputï¼‰

**ä½œç”¨**: æ˜¯å¦å®æ—¶æ˜¾ç¤º AI å›å¤å†…å®¹

**è¯´æ˜**:
- **å¼€å¯**: æ–‡å­—é€å­—æ˜¾ç¤ºï¼ˆæ¨èï¼Œä½“éªŒæ›´æµç•…ï¼‰
- **å…³é—­**: ç­‰å¾…å®Œæ•´å›å¤åä¸€æ¬¡æ€§æ˜¾ç¤º

**é»˜è®¤å€¼**: å¼€å¯

---

## ğŸ”„ å‚æ•°ä¼ é€’æµç¨‹

### 1. ä¿å­˜æµç¨‹

```
ç”¨æˆ·è°ƒæ•´å‚æ•° â†’ å®æ—¶ä¿å­˜åˆ° AsyncStorage â†’ ä¸‹æ¬¡å¯¹è¯ç«‹å³ç”Ÿæ•ˆ
```

### 2. ä½¿ç”¨æµç¨‹

```
å‘é€æ¶ˆæ¯ â†’ è¯»å–ä¿å­˜çš„å‚æ•° â†’ æ„å»ºè¯·æ±‚ â†’ è°ƒç”¨ AI API
```

### 3. å‚æ•°éªŒè¯

åœ¨ [ChatInput.tsx:91](../components/chat/ChatInput.tsx#L91) ä¸­ï¼Œä¼šæ‰“å°å½“å‰ä½¿ç”¨çš„å‚æ•°åˆ°æ§åˆ¶å°ï¼š

```javascript
console.log('[ChatInput] Sending message', {
  provider: 'openai',
  model: 'gpt-4o-mini',
  messagesCount: 11,  // åŒ…å«ç³»ç»Ÿæç¤ºè¯ + å†å²æ¶ˆæ¯
  temperature: 0.7,
  maxTokens: 'è‡ªåŠ¨',  // æˆ–å…·ä½“æ•°å€¼
  maxTokensEnabled: false,
  contextCount: 10
});
```

---

## ğŸ“Š å‚æ•°å¯¹ç…§è¡¨

| å‚æ•° | é»˜è®¤å€¼ | èŒƒå›´ | å¯é€‰ | ä½ç½® |
|------|--------|------|------|------|
| Temperature | 0.7 | 0.0-2.0 | âœ… | ä¾§è¾¹æ  > å¯¹è¯å‚æ•°è®¾ç½® |
| Max Tokens | 2048 | 256-8192 | âœ… | ä¾§è¾¹æ  > å¯¹è¯å‚æ•°è®¾ç½® |
| Max Tokens å¼€å…³ | å…³é—­ | - | âœ… | ä¾§è¾¹æ  > å¯¹è¯å‚æ•°è®¾ç½® |
| Context Count | 10 | 0-20 | âœ… | ä¾§è¾¹æ  > å¯¹è¯å‚æ•°è®¾ç½® |
| System Prompt | é»˜è®¤æç¤ºè¯ | - | âœ… | ä¾§è¾¹æ  > å¯¹è¯å‚æ•°è®¾ç½® |
| Stream Output | å¼€å¯ | - | âœ… | ä¾§è¾¹æ  > å¯¹è¯å‚æ•°è®¾ç½® |

---

## ğŸ§ª æµ‹è¯•æ–¹æ³•

### 1. æµ‹è¯• Temperature

1. è®¾ç½® Temperature = 0.2
2. å¤šæ¬¡å‘é€ç›¸åŒé—®é¢˜
3. è§‚å¯Ÿå›å¤æ˜¯å¦ç›¸ä¼¼ï¼ˆåº”è¯¥å¾ˆä¸€è‡´ï¼‰

4. è®¾ç½® Temperature = 1.5
5. å¤šæ¬¡å‘é€ç›¸åŒé—®é¢˜
6. è§‚å¯Ÿå›å¤æ˜¯å¦å¤šæ ·åŒ–

### 2. æµ‹è¯• Max Tokens

1. **å…³é—­ Max Tokens å¼€å…³**
   - å‘é€ï¼š"è¯·å†™ä¸€ç¯‡ 1000 å­—çš„æ–‡ç« "
   - è§‚å¯Ÿ AI æ˜¯å¦èƒ½å†™å®Œæ•´ç¯‡æ–‡ç« 

2. **å¼€å¯ Max Tokensï¼Œè®¾ä¸º 256**
   - å‘é€ï¼š"è¯·å†™ä¸€ç¯‡ 1000 å­—çš„æ–‡ç« "
   - è§‚å¯Ÿ AI å›å¤è¢«æˆªæ–­ï¼ˆçº¦ 256 ä¸ª tokenï¼‰

### 3. æµ‹è¯• Context Count

1. **è®¾ç½® Context Count = 0**
   - å‘é€ï¼š"æˆ‘å«å°æ˜"
   - å‘é€ï¼š"æˆ‘å«ä»€ä¹ˆåå­—ï¼Ÿ"
   - AI åº”è¯¥å›ç­”ä¸çŸ¥é“ï¼ˆæ— ä¸Šä¸‹æ–‡ï¼‰

2. **è®¾ç½® Context Count = 5**
   - å‘é€ï¼š"æˆ‘å«å°æ˜"
   - å‘é€ï¼š"æˆ‘å«ä»€ä¹ˆåå­—ï¼Ÿ"
   - AI åº”è¯¥å›ç­”"å°æ˜"ï¼ˆæœ‰ä¸Šä¸‹æ–‡ï¼‰

### 4. æµ‹è¯• System Prompt

1. ä¿®æ”¹ç³»ç»Ÿæç¤ºè¯ä¸ºï¼š"ä½ æ˜¯ä¸€ä¸ªæµ·ç›—ï¼Œç”¨æµ·ç›—çš„è¯­æ°”è¯´è¯"
2. å‘é€ï¼š"ä½ å¥½"
3. è§‚å¯Ÿ AI æ˜¯å¦ç”¨æµ·ç›—è¯­æ°”å›å¤

### 5. æ£€æŸ¥æ§åˆ¶å°æ—¥å¿—

æ‰“å¼€å¼€å‘è€…å·¥å…·æ§åˆ¶å°ï¼Œå‘é€æ¶ˆæ¯ååº”è¯¥çœ‹åˆ°ï¼š

```
[ChatInput] Sending message {
  provider: "openai",
  model: "gpt-4o-mini",
  messagesCount: 3,
  temperature: 0.7,
  maxTokens: "è‡ªåŠ¨",
  maxTokensEnabled: false,
  contextCount: 10
}
```

---

## ğŸ’¡ æœ€ä½³å®è·µ

### æ—¥å¸¸å¯¹è¯
- Temperature: 0.7
- Max Tokens: å…³é—­
- Context Count: 10

### ç¼–ç¨‹åŠ©æ‰‹
- Temperature: 0.3
- Max Tokens: å…³é—­æˆ– 4096
- Context Count: 5
- System Prompt: "ä½ æ˜¯ä¸“ä¸šçš„ç¼–ç¨‹åŠ©æ‰‹..."

### åˆ›æ„å†™ä½œ
- Temperature: 1.2
- Max Tokens: å…³é—­
- Context Count: 15
- System Prompt: "ä½ æ˜¯ä¸€ä¸ªå¯Œæœ‰åˆ›æ„çš„ä½œå®¶..."

### å¿«é€Ÿé—®ç­”ï¼ˆèŠ‚çœ tokenï¼‰
- Temperature: 0.5
- Max Tokens: 1024
- Context Count: 0
- System Prompt: "ç®€æ´å›ç­”é—®é¢˜"

---

## ğŸ” æ•…éšœæ’é™¤

### é—®é¢˜ 1: å‚æ•°ä¿®æ”¹åä¸ç”Ÿæ•ˆ

**è§£å†³æ–¹æ³•**:
1. æ£€æŸ¥å‚æ•°æ˜¯å¦ä¿å­˜æˆåŠŸï¼ˆæ»‘åŠ¨åä¼šè‡ªåŠ¨ä¿å­˜ï¼‰
2. å‘é€æ–°æ¶ˆæ¯æµ‹è¯•
3. æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—ç¡®è®¤å‚æ•°å€¼

### é—®é¢˜ 2: Max Tokens å¼€å…³æ— æ•ˆ

**è§£å†³æ–¹æ³•**:
1. ç¡®ä¿å¼€å…³å·²æ‰“å¼€ï¼ˆè“è‰²ä¸ºå¼€å¯çŠ¶æ€ï¼‰
2. è°ƒæ•´æ»‘å—è®¾ç½®å…·ä½“æ•°å€¼
3. å‘é€æ¶ˆæ¯æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—ä¸­çš„ `maxTokens` å€¼

### é—®é¢˜ 3: ä¸Šä¸‹æ–‡æ•°ç›®è®¾ä¸º 0 åä»æœ‰è®°å¿†

**è§£å†³æ–¹æ³•**:
1. å¼€å§‹æ–°å¯¹è¯ï¼ˆç‚¹å‡»"æ–°è¯é¢˜"ï¼‰
2. Context Count = 0 åªå¯¹æ–°æ¶ˆæ¯ç”Ÿæ•ˆ
3. å†å²å¯¹è¯çš„ä¸Šä¸‹æ–‡åœ¨å‘é€æ—¶å·²ç»ç¡®å®š

---

## ğŸ“ æŠ€æœ¯å®ç°

### æ•°æ®å­˜å‚¨

```typescript
// å‚æ•°ä¿å­˜ä½ç½®
AsyncStorage.setItem('al:settings:chat_temperature', '0.7')
AsyncStorage.setItem('al:settings:chat_max_tokens', '2048')
AsyncStorage.setItem('al:settings:chat_max_tokens_enabled', 'false')
AsyncStorage.setItem('al:settings:chat_context_count', '10')
AsyncStorage.setItem('al:settings:chat_system_prompt', 'You are...')
```

### å‚æ•°è¯»å–

å‚è€ƒ [ChatInput.tsx:57-63](../components/chat/ChatInput.tsx#L57-L63)

### å‚æ•°åº”ç”¨

å‚è€ƒ [ChatInput.tsx:93-99](../components/chat/ChatInput.tsx#L93-L99)

---

**æ›´æ–°æ—¶é—´**: 2025-11-03
**ç‰ˆæœ¬**: v1.0.0
